[sql]
sql_pro = SELECT DISTINCT(p.PROVINCE),p.provinceid FROM shop_info s INNER JOIN area a ON s.AREA_CODE = a.AREAID AND s.shop_status = 3 INNER JOIN city c ON c.CITYID = a.FATHERID INNER JOIN province p ON p.PROVINCEID = c.FATHERID
sql_city = SELECT DISTINCT(c.city), c.cityid FROM shop_info s INNER JOIN area a ON s.AREA_CODE = a.AREAID AND s.shop_status = 3 INNER JOIN city c ON c.CITYID = a.FATHERID INNER JOIN province p ON p.PROVINCEID = c.FATHERID where p.provinceid=
sql_area = SELECT DISTINCT(a.area), a.areaid FROM shop_info s INNER JOIN area a ON s.AREA_CODE = a.AREAID AND s.shop_status = 3 INNER JOIN city c ON c.CITYID = a.FATHERID INNER JOIN province p ON p.PROVINCEID = c.FATHERID WHERE c.cityid=

sql_payrate1 = select round(sum(real_amount),2) as  "实际支付",round(sum(bill_time_precharge),2) as "E币",round(sum(discount),2) as "优惠券"from shop_dailyorder_income where provinceid=province_ and cityid=city_ and areaid=area_ AND income_date = yes_time
sql_payrate2 = select round(sum(real_amount),2) as  "实际支付",round(sum(bill_time_precharge),2) as "E币",round(sum(discount),2) as "优惠券"from shop_dailyorder_income where provinceid=province_ and cityid=city_ AND income_date = yes_time
sql_payrate3 = select round(sum(real_amount),2) as  "实际支付",round(sum(bill_time_precharge),2) as "E币",round(sum(discount),2) as "优惠券"from shop_dailyorder_income where provinceid=province_ AND income_date = yes_time
sql_payrate4 = select round(sum(real_amount),2) as  "实际支付",round(sum(bill_time_precharge),2) as "E币",round(sum(discount),2) as "优惠券"from shop_dailyorder_income where shop_seq=shop__ AND income_date = yes_time
sql_payrate5 = select round(sum(real_amount),2) as  "实际支付",round(sum(bill_time_precharge),2) as "E币",round(sum(discount),2) as "优惠券" from shop_dailyorder_income where income_date = yes_time

sql_payrate_zhexian1 = SELECT income_date, round(sum(amount), 2)AS total, round(sum(real_amount), 2)AS actual, round(sum(bill_time_precharge), 2)AS coupon, round(sum(discount), 2)AS ecurrency FROM shop_dailyorder_income WHERE PROVINCEID = get_provinced_id AND cityid = get_city_id AND AREAID = get_area_id AND income_date >= seven_days_time AND income_date < now_time GROUP BY income_date
sql_payrate_zhexian2 = SELECT income_date, round(sum(amount), 2)AS total, round(sum(real_amount), 2)AS actual, round(sum(bill_time_precharge), 2)AS coupon, round(sum(discount), 2)AS ecurrency FROM shop_dailyorder_income WHERE PROVINCEID = get_provinced_id AND cityid = get_city_id AND income_date >= seven_days_time AND income_date < now_time GROUP BY income_date
sql_payrate_zhexian3 = SELECT income_date, round(sum(amount), 2)AS total, round(sum(real_amount), 2)AS actual, round(sum(bill_time_precharge), 2)AS coupon, round(sum(discount), 2)AS ecurrency FROM shop_dailyorder_income WHERE PROVINCEID = get_provinced_id AND income_date >= seven_days_time AND income_date < now_time GROUP BY income_date
sql_payrate_zhexian4 = SELECT income_date, round(sum(amount), 2)AS total, round(sum(real_amount), 2)AS actual, round(sum(bill_time_precharge), 2)AS coupon, round(sum(discount), 2)AS ecurrency FROM shop_dailyorder_income WHERE shop_seq = shop__ AND income_date >= seven_days_time AND income_date < now_time GROUP BY income_date
sql_payrate_zhexian5 = SELECT income_date, round(sum(amount), 2)AS total, round(sum(real_amount), 2)AS actual, round(sum(bill_time_precharge), 2)AS coupon, round(sum(discount), 2)AS ecurrency FROM shop_dailyorder_income WHERE income_date >= seven_days_time AND income_date < now_time GROUP BY income_date

sql_shop = WITH temp(maxAmount) AS ( SELECT max(amount) AS maxAmount FROM shop_dailyorder_income WHERE longitude >= long1 AND longitude <= long2 AND latitude >= lati2 AND latitude <= lati1 AND income_date = "yes_time"), temp1 ( shop_name, longitude, latitude, amount, shop_seq ) AS ( SELECT shop_name, longitude, latitude, amount, shop_seq FROM shop_dailyorder_income WHERE longitude >= long1 AND longitude <= long2 AND latitude >= lati2 AND latitude <= lati1 AND income_date = "yes_time" ) SELECT temp1.shop_name as name, temp1.longitude, temp1.latitude, round( temp1.amount / temp.maxAmount* 100 ) as rate, temp1.shop_seq FROM temp1, temp
